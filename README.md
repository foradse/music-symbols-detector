# Music Symbols Recognition System

## Описание

**Music Symbols Recognition System** — это комплексный проект для автоматизации распознавания музыкальных символов на изображениях нотных листов с помощью методов компьютерного зрения и нейросетей.

Проект включает:
- инструменты для ручной разметки и подготовки датасета,
- модули для препроцессинга и нарезки изображений,
- инфраструктуру для обучения и тестирования моделей,
- (в перспективе) сервисы для инференса и интеграции с внешними приложениями.

---

## Цели проекта
- Автоматизировать распознавание нотных символов (диезы, бемоли, ключи, паузы и др.) на сканах и фотографиях нот.
- Обеспечить полный цикл: от сбора и разметки данных до обучения и применения нейросетевых моделей.
- Создать расширяемую платформу для исследований в области Optical Music Recognition (OMR).

---

## Архитектура проекта

Проект построен по модульному принципу и включает следующие ключевые этапы и компоненты:

1. **Сбор и разметка данных**
   - `input/` — исходные изображения для разметки и обучения.
   - `input-storage/` — временное хранилище (резервные копии, тестовые данные).
   - `symbol_labeler/labeler.py` — графическая утилита для ручной сортировки и аннотирования символов по классам.
   - `symbol_labeler/symbols.txt` — список классов для разметки.
   - `output/` — результат разметки: изображения по папкам классов и файл аннотаций `labels.txt`.

2. **Препроцессинг и подготовка датасета**
   - (Планируется) Модули для автоматической нарезки нотных строк на отдельные символы, аугментации и очистки данных.
   - `output/clear_output.py` — скрипт для очистки результатов разметки.

3. **Обучение и тестирование моделей**
   - `recognize/` — папка для хранения скриптов, моделей, итоговых датасетов и результатов обучения/тестирования.
   - (Планируется) Модули для запуска обучения, валидации и оценки качества моделей.

4. **Инференс и интеграция**
   - (Планируется) Модули для применения обученных моделей к новым изображениям, интеграция с внешними сервисами и API.

---

## Инструкция по использованию (разметка и подготовка данных)

### 1. Подготовка данных
- Поместите неразмеченные изображения в папку `input/`.
- Для временного хранения используйте `input-storage/`.

### 2. Ручная разметка
- Запустите:
  ```bash
  python symbol_labeler/labeler.py
  ```
- Используйте горячие клавиши для сортировки по классам (см. `symbols.txt`).
- После разметки изображения автоматически перемещаются в `output/positive/<класс>/` или `output/negative/`.
- Аннотации сохраняются в `output/labels.txt`.

### 3. Очистка результатов (по необходимости)
- Для сброса состояния используйте:
  ```bash
  python output/clear_output.py
  ```

### 4. Сборка датасета для обучения
- После разметки используйте содержимое `output/` для формирования обучающей и тестовой выборки.
- Для интеграции с ML-скриптами используйте папку `recognize/`.

---

## symbols.txt
- Список всех классов для разметки (по одному в строке).
- Для добавления нового класса просто добавьте его название в этот файл.

---

## Частые ошибки и рекомендации
- **Файл не отображается в интерфейсе:** проверьте расширение и расположение.
- **Файл не перемещается:** проверьте права на запись в `output/`.
- **Аннотация не добавляется:** убедитесь, что `labels.txt` не открыт в другой программе.
- **Потеря данных при отмене:** восстановить удалённый файл невозможно.

---

## Планы по развитию
- Реализация автоматической нарезки нотных строк на символы (модуль crop_symbols.py).
- Разработка и интеграция нейросетевых моделей для классификации и локализации символов.
- Поддержка инференса и API для внешних приложений.
- Расширение набора классов и автоматизация аугментаций.

---

## Расширяемость и поддержка
- Проект легко расширяется: добавляйте новые классы в `symbols.txt`, новые изображения в `input/`.
- Для интеграции с ML-пайплайном используйте папку `recognize/`.
- Все скрипты написаны на Python и не требуют специфических зависимостей, кроме стандартных библиотек и Pillow.

---

## Контакты и поддержка
Если у вас возникли вопросы, предложения или требуется помощь с использованием проекта — обращайтесь к автору или создайте issue в репозитории.

---

## Служебные скрипты

### clear_output.py

Скрипт `output/clear_output.py` предназначен для полной очистки папки `output/` от всех файлов и папок, кроме служебных файлов `.gitkeep` и самого скрипта `clear_output.py`.

**Использование:**

```bash
python output/clear_output.py
```

- После запуска все размеченные изображения, аннотации и подпапки в `output/` будут удалены.
- Скрипт полезен для сброса состояния перед новой разметкой или тестированием.
- **Внимание:** восстановить удалённые данные будет невозможно!

---


