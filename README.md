# Music Symbols Dataset Project


## Цели проекта
- Сформировать структурированный датасет музыкальных символов для обучения и тестирования моделей.
- Обеспечить удобный и прозрачный процесс ручной разметки с помощью специализированного инструмента.
- Поддерживать расширяемость и воспроизводимость пайплайна для дальнейших исследований и экспериментов.

---

## Структура репозитория

```
project-root/
├── input/                # Исходные изображения для разметки
├── input-storage/        # Временное хранилище (резервные копии, тестовые данные)
├── output/               # Размеченные изображения и аннотации
│   ├── positive/
│   │    ├── diez/
│   │    ├── flat/
│   │    └── ...
│   └── negative/
│   └── labels.txt        # Аннотации: имя файла, класс
├── recognize/            # Итоговый датасет для обучения/тестирования
├── symbol_labeler/
│   ├── labeler.py        # Программа для ручной сортировки и разметки
│   └── symbols.txt       # Список классов (по одному в строке)
└── ...
```

---

## Инструкция по использованию

### 1. Подготовка данных
- Поместите все неразмеченные или новые изображения музыкальных символов в папку `input/`.
- Для временного хранения или тестирования используйте папку `input-storage/`.

### 2. Запуск программы разметки
- Откройте терминал в корневой папке проекта.
- Запустите программу разметки:
  ```bash
  python symbol_labeler/labeler.py
  ```
- В интерфейсе:
  - Слева отображается список классов с номерами (см. `symbols.txt`).
  - Справа — увеличенное изображение текущего символа.
  - В нижней части — кнопки "Отменить", "Удалить", "Закрыть".
- Для разметки используйте горячие клавиши:
  - `1–9, 10...` — соответствующий класс
  - `0` или `n` — негативный пример
  - `z` — отменить последнее действие
  - `x` — удалить файл
  - `q` — закрыть программу
- После выбора класса изображение автоматически перемещается в соответствующую папку внутри `output/positive/<класс>/` или `output/negative/`.
- В файл `output/labels.txt` добавляется строка: `имя_файла,класс`

### 3. Формирование итогового датасета
- После завершения разметки все отсортированные изображения находятся в `output/positive/<класс>/` и `output/negative/`.
- Аннотации — в `output/labels.txt`.
- Для обучения или тестирования скопируйте необходимые данные в папку `recognize/` или используйте её для запуска ML-скриптов.

---

## symbols.txt
- Файл `symbol_labeler/symbols.txt` содержит список всех классов для разметки (по одному в строке).
- Для добавления нового класса просто добавьте его название в этот файл.

---

## Частые ошибки и рекомендации

- **Файл не отображается в интерфейсе:**
  - Проверьте, что изображение находится в папке `input/` и имеет поддерживаемое расширение (`.png`, `.jpg`, `.jpeg`).
- **Файл не перемещается после разметки:**
  - Убедитесь, что у вас есть права на запись в папку `output/`.
- **Аннотация не добавляется:**
  - Проверьте, что файл `output/labels.txt` не открыт в другой программе.
- **Неправильный класс:**
  - Проверьте соответствие номеров классов в интерфейсе и в файле `symbols.txt`.
- **Потеря данных при отмене:**
  - Функция "Отменить" работает только для последнего действия перемещения. Восстановить удалённый файл невозможно.

---

## Расширяемость и поддержка
- Проект легко расширяется: добавляйте новые классы в `symbols.txt`, новые изображения в `input/`.
- Для интеграции с ML-пайплайном используйте папку `recognize/`.
- Все скрипты написаны на Python и не требуют специфических зависимостей, кроме стандартных библиотек и Pillow.

---

## Контакты и поддержка
Если у вас возникли вопросы, предложения или требуется помощь с использованием проекта — обращайтесь к автору или создайте issue в репозитории.

---

## Служебные скрипты

### clear_output.py

Скрипт `output/clear_output.py` предназначен для полной очистки папки `output/` от всех файлов и папок, кроме служебных файлов `.gitkeep` и самого скрипта `clear_output.py`.

**Использование:**

```bash
python output/clear_output.py
```

- После запуска все размеченные изображения, аннотации и подпапки в `output/` будут удалены.
- Скрипт полезен для сброса состояния перед новой разметкой или тестированием.
- **Внимание:** восстановить удалённые данные будет невозможно!

---


